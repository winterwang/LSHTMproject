library(readr)
CARB_50_LGCA_3CLASS <- read_table2("results/LCGA/CARB_50_LGCA_3CLASS.DAT", 
                                   col_names = FALSE)

head(CARB_50_LGCA_3CLASS)


names(CARB_50_LGCA_3CLASS) <- c(
  "H0_X",  "H1_X",
  "H2_X",  "H3_X",
  "H4_X",  "H5_X",
  "H6_X",  "H7_X",
  "H8_X",  "H9_X",
  "H10_X",  "H11_X",
  "H12_X",  "H13_X",
  "H14_X",  "H15_X",
  "H16_X",  "H17_X",
  "H18_X",  "H19_X",
  "H20_X",  "H21_X",
  "H22_X",  "H23_X",
  "H0_Y",  "H1_Y",
  "H2_Y",  "H3_Y",
  "H4_Y",  "H5_Y",
  "H6_Y",  "H7_Y",
  "H8_Y",  "H9_Y",
  "H10_Y",  "H11_Y",
  "H12_Y",  "H13_Y",
  "H14_Y",  "H15_Y",
  "H16_Y",  "H17_Y",
  "H18_Y",  "H19_Y",
  "H20_Y",  "H21_Y",
  "H22_Y",  "H23_Y",
  "H0_X_X",  "H1_X_X",
  "H2_X_X",  "H3_X_X",
  "H4_X_X",  "H5_X_X",
  "H6_X_X",  "H7_X_X",
  "H8_X_X",  "H9_X_X",
  "H10_X_X",  "H11_X_X",
  "H12_X_X",  "H13_X_X",
  "H14_X_X",  "H15_X_X",
  "H16_X_X",  "H17_X_X",
  "H18_X_X",  "H19_X_X",
  "H20_X_X",  "H21_X_X",
  "H22_X_X",  "H23_X_X",
  "H0_Y_Y",  "H1_Y_Y",
  "H2_Y_Y",  "H3_Y_Y",
  "H4_Y_Y",  "H5_Y_Y",
  "H6_Y_Y",  "H7_Y_Y",
  "H8_Y_Y",  "H9_Y_Y",
  "H10_Y_Y",  "H11_Y_Y",
  "H12_Y_Y",  "H13_Y_Y",
  "H14_Y_Y",  "H15_Y_Y",
  "H16_Y_Y",  "H17_Y_Y",
  "H18_Y_Y",  "H19_Y_Y",
  "H20_Y_Y",  "H21_Y_Y",
  "H22_Y_Y",  "H23_Y_Y",
  "ID",
  "CPROB1",  "CPROB2",
  "CPROB3",  "C"
)


CARB_50_LGCA_3CLASS[CARB_50_LGCA_3CLASS == "*"] <- NA


ppd1 <- CARB_50_LGCA_3CLASS %>% 
  group_by(C) %>% 
  summarise(d1H0_0 = sum(H0_X == 0, na.rm = T)/length(H0_X), 
            d1H0_1 = sum(H0_X == 1, na.rm = T)/length(H0_X), 
            d1H0_2 = sum(H0_X == 2, na.rm = T)/length(H0_X),
            d1H1_0 = sum(H1_X == 0, na.rm = T)/length(H1_X),
            d1H1_1 = sum(H1_X == 1, na.rm = T)/length(H1_X), 
            d1H1_2 = sum(H1_X == 2, na.rm = T)/length(H1_X),
            d1H2_0 = sum(H2_X == 0, na.rm = T)/length(H2_X),
            d1H2_1 = sum(H2_X == 1, na.rm = T)/length(H2_X), 
            d1H2_2 = sum(H2_X == 2, na.rm = T)/length(H2_X),
            d1H3_0 = sum(H3_X == 0, na.rm = T)/length(H3_X),
            d1H3_1 = sum(H3_X == 1, na.rm = T)/length(H3_X), 
            d1H3_2 = sum(H3_X == 2, na.rm = T)/length(H3_X),
            d1H4_0 = sum(H4_X == 0, na.rm = T)/length(H4_X),
            d1H4_1 = sum(H4_X == 1, na.rm = T)/length(H4_X), 
            d1H4_2 = sum(H4_X == 2, na.rm = T)/length(H4_X),
            d1H5_0 = sum(H5_X == 0, na.rm = T)/length(H5_X),
            d1H5_1 = sum(H5_X == 1, na.rm = T)/length(H5_X), 
            d1H5_2 = sum(H5_X == 2, na.rm = T)/length(H5_X),
            d1H6_0 = sum(H6_X == 0, na.rm = T)/length(H6_X),
            d1H6_1 = sum(H6_X == 1, na.rm = T)/length(H6_X), 
            d1H6_2 = sum(H6_X == 2, na.rm = T)/length(H6_X),
            d1H7_0 = sum(H7_X == 0, na.rm = T)/length(H7_X),
            d1H7_1 = sum(H7_X == 1, na.rm = T)/length(H7_X), 
            d1H7_2 = sum(H7_X == 2, na.rm = T)/length(H7_X),
            d1H8_0 = sum(H8_X == 0, na.rm = T)/length(H8_X),
            d1H8_1 = sum(H8_X == 1, na.rm = T)/length(H8_X), 
            d1H8_2 = sum(H8_X == 2, na.rm = T)/length(H8_X),
            d1H9_0 = sum(H9_X == 0, na.rm = T)/length(H9_X),
            d1H9_1 = sum(H9_X == 1, na.rm = T)/length(H9_X), 
            d1H9_2 = sum(H9_X == 2, na.rm = T)/length(H9_X),
            d1H10_0 = sum(H10_X == 0, na.rm = T)/length(H10_X),
            d1H10_1 = sum(H10_X == 1, na.rm = T)/length(H10_X), 
            d1H10_2 = sum(H10_X == 2, na.rm = T)/length(H10_X),
            d1H11_0 = sum(H11_X == 0, na.rm = T)/length(H11_X),
            d1H11_1 = sum(H11_X == 1, na.rm = T)/length(H11_X), 
            d1H11_2 = sum(H11_X == 2, na.rm = T)/length(H11_X),
            d1H12_0 = sum(H12_X == 0, na.rm = T)/length(H12_X),
            d1H12_1 = sum(H12_X == 1, na.rm = T)/length(H12_X), 
            d1H12_2 = sum(H12_X == 2, na.rm = T)/length(H12_X),
            d1H13_0 = sum(H13_X == 0, na.rm = T)/length(H13_X),
            d1H13_1 = sum(H13_X == 1, na.rm = T)/length(H13_X), 
            d1H13_2 = sum(H13_X == 2, na.rm = T)/length(H13_X),
            d1H14_0 = sum(H14_X == 0, na.rm = T)/length(H14_X),
            d1H14_1 = sum(H14_X == 1, na.rm = T)/length(H14_X), 
            d1H14_2 = sum(H14_X == 2, na.rm = T)/length(H14_X),
            d1H15_0 = sum(H15_X == 0, na.rm = T)/length(H15_X),
            d1H15_1 = sum(H15_X == 1, na.rm = T)/length(H15_X), 
            d1H15_2 = sum(H15_X == 2, na.rm = T)/length(H15_X),
            d1H16_0 = sum(H16_X == 0, na.rm = T)/length(H16_X),
            d1H16_1 = sum(H16_X == 1, na.rm = T)/length(H16_X), 
            d1H16_2 = sum(H16_X == 2, na.rm = T)/length(H16_X),
            d1H17_0 = sum(H17_X == 0, na.rm = T)/length(H17_X),
            d1H17_1 = sum(H17_X == 1, na.rm = T)/length(H17_X), 
            d1H17_2 = sum(H17_X == 2, na.rm = T)/length(H17_X),
            d1H18_0 = sum(H18_X == 0, na.rm = T)/length(H18_X),
            d1H18_1 = sum(H18_X == 1, na.rm = T)/length(H18_X), 
            d1H18_2 = sum(H18_X == 2, na.rm = T)/length(H18_X),
            d1H19_0 = sum(H19_X == 0, na.rm = T)/length(H19_X),
            d1H19_1 = sum(H19_X == 1, na.rm = T)/length(H19_X), 
            d1H19_2 = sum(H19_X == 2, na.rm = T)/length(H19_X),
            d1H20_0 = sum(H20_X == 0, na.rm = T)/length(H20_X),
            d1H20_1 = sum(H20_X == 1, na.rm = T)/length(H20_X), 
            d1H20_2 = sum(H20_X == 2, na.rm = T)/length(H20_X),
            d1H21_0 = sum(H21_X == 0, na.rm = T)/length(H21_X),
            d1H21_1 = sum(H21_X == 1, na.rm = T)/length(H21_X), 
            d1H21_2 = sum(H21_X == 2, na.rm = T)/length(H21_X),
            d1H22_0 = sum(H22_X == 0, na.rm = T)/length(H22_X),
            d1H22_1 = sum(H22_X == 1, na.rm = T)/length(H22_X), 
            d1H22_2 = sum(H22_X == 2, na.rm = T)/length(H22_X),
            d1H23_0 = sum(H23_X == 0, na.rm = T)/length(H23_X),
            d1H23_1 = sum(H23_X == 1, na.rm = T)/length(H23_X), 
            d1H23_2 = sum(H23_X == 2, na.rm = T)/length(H23_X))


ppd2 <- CARB_50_LGCA_3CLASS %>% 
  group_by(C) %>% 
  summarise(d2H0_0 = sum(H0_Y == 0, na.rm = T)/length(H0_Y), 
            d2H0_1 = sum(H0_Y == 1, na.rm = T)/length(H0_Y), 
            d2H0_2 = sum(H0_Y == 2, na.rm = T)/length(H0_Y),
            d2H1_0 = sum(H1_Y == 0, na.rm = T)/length(H1_Y),
            d2H1_1 = sum(H1_Y == 1, na.rm = T)/length(H1_Y), 
            d2H1_2 = sum(H1_Y == 2, na.rm = T)/length(H1_Y),
            d2H2_0 = sum(H2_Y == 0, na.rm = T)/length(H2_Y),
            d2H2_1 = sum(H2_Y == 1, na.rm = T)/length(H2_Y), 
            d2H2_2 = sum(H2_Y == 2, na.rm = T)/length(H2_Y),
            d2H3_0 = sum(H3_Y == 0, na.rm = T)/length(H3_Y),
            d2H3_1 = sum(H3_Y == 1, na.rm = T)/length(H3_Y), 
            d2H3_2 = sum(H3_Y == 2, na.rm = T)/length(H3_Y),
            d2H4_0 = sum(H4_Y == 0, na.rm = T)/length(H4_Y),
            d2H4_1 = sum(H4_Y == 1, na.rm = T)/length(H4_Y), 
            d2H4_2 = sum(H4_Y == 2, na.rm = T)/length(H4_Y),
            d2H5_0 = sum(H5_Y == 0, na.rm = T)/length(H5_Y),
            d2H5_1 = sum(H5_Y == 1, na.rm = T)/length(H5_Y), 
            d2H5_2 = sum(H5_Y == 2, na.rm = T)/length(H5_Y),
            d2H6_0 = sum(H6_Y == 0, na.rm = T)/length(H6_Y),
            d2H6_1 = sum(H6_Y == 1, na.rm = T)/length(H6_Y), 
            d2H6_2 = sum(H6_Y == 2, na.rm = T)/length(H6_Y),
            d2H7_0 = sum(H7_Y == 0, na.rm = T)/length(H7_Y),
            d2H7_1 = sum(H7_Y == 1, na.rm = T)/length(H7_Y), 
            d2H7_2 = sum(H7_Y == 2, na.rm = T)/length(H7_Y),
            d2H8_0 = sum(H8_Y == 0, na.rm = T)/length(H8_Y),
            d2H8_1 = sum(H8_Y == 1, na.rm = T)/length(H8_Y), 
            d2H8_2 = sum(H8_Y == 2, na.rm = T)/length(H8_Y),
            d2H9_0 = sum(H9_Y == 0, na.rm = T)/length(H9_Y),
            d2H9_1 = sum(H9_Y == 1, na.rm = T)/length(H9_Y), 
            d2H9_2 = sum(H9_Y == 2, na.rm = T)/length(H9_Y),
            d2H10_0 = sum(H10_Y == 0, na.rm = T)/length(H10_Y),
            d2H10_1 = sum(H10_Y == 1, na.rm = T)/length(H10_Y), 
            d2H10_2 = sum(H10_Y == 2, na.rm = T)/length(H10_Y),
            d2H11_0 = sum(H11_Y == 0, na.rm = T)/length(H11_Y),
            d2H11_1 = sum(H11_Y == 1, na.rm = T)/length(H11_Y), 
            d2H11_2 = sum(H11_Y == 2, na.rm = T)/length(H11_Y),
            d2H12_0 = sum(H12_Y == 0, na.rm = T)/length(H12_Y),
            d2H12_1 = sum(H12_Y == 1, na.rm = T)/length(H12_Y), 
            d2H12_2 = sum(H12_Y == 2, na.rm = T)/length(H12_Y),
            d2H13_0 = sum(H13_Y == 0, na.rm = T)/length(H13_Y),
            d2H13_1 = sum(H13_Y == 1, na.rm = T)/length(H13_Y), 
            d2H13_2 = sum(H13_Y == 2, na.rm = T)/length(H13_Y),
            d2H14_0 = sum(H14_Y == 0, na.rm = T)/length(H14_Y),
            d2H14_1 = sum(H14_Y == 1, na.rm = T)/length(H14_Y), 
            d2H14_2 = sum(H14_Y == 2, na.rm = T)/length(H14_Y),
            d2H15_0 = sum(H15_Y == 0, na.rm = T)/length(H15_Y),
            d2H15_1 = sum(H15_Y == 1, na.rm = T)/length(H15_Y), 
            d2H15_2 = sum(H15_Y == 2, na.rm = T)/length(H15_Y),
            d2H16_0 = sum(H16_Y == 0, na.rm = T)/length(H16_Y),
            d2H16_1 = sum(H16_Y == 1, na.rm = T)/length(H16_Y), 
            d2H16_2 = sum(H16_Y == 2, na.rm = T)/length(H16_Y),
            d2H17_0 = sum(H17_Y == 0, na.rm = T)/length(H17_Y),
            d2H17_1 = sum(H17_Y == 1, na.rm = T)/length(H17_Y), 
            d2H17_2 = sum(H17_Y == 2, na.rm = T)/length(H17_Y),
            d2H18_0 = sum(H18_Y == 0, na.rm = T)/length(H18_Y),
            d2H18_1 = sum(H18_Y == 1, na.rm = T)/length(H18_Y), 
            d2H18_2 = sum(H18_Y == 2, na.rm = T)/length(H18_Y),
            d2H19_0 = sum(H19_Y == 0, na.rm = T)/length(H19_Y),
            d2H19_1 = sum(H19_Y == 1, na.rm = T)/length(H19_Y), 
            d2H19_2 = sum(H19_Y == 2, na.rm = T)/length(H19_Y),
            d2H20_0 = sum(H20_Y == 0, na.rm = T)/length(H20_Y),
            d2H20_1 = sum(H20_Y == 1, na.rm = T)/length(H20_Y), 
            d2H20_2 = sum(H20_Y == 2, na.rm = T)/length(H20_Y),
            d2H21_0 = sum(H21_Y == 0, na.rm = T)/length(H21_Y),
            d2H21_1 = sum(H21_Y == 1, na.rm = T)/length(H21_Y), 
            d2H21_2 = sum(H21_Y == 2, na.rm = T)/length(H21_Y),
            d2H22_0 = sum(H22_Y == 0, na.rm = T)/length(H22_Y),
            d2H22_1 = sum(H22_Y == 1, na.rm = T)/length(H22_Y), 
            d2H22_2 = sum(H22_Y == 2, na.rm = T)/length(H22_Y),
            d2H23_0 = sum(H23_Y == 0, na.rm = T)/length(H23_Y),
            d2H23_1 = sum(H23_Y == 1, na.rm = T)/length(H23_Y), 
            d2H23_2 = sum(H23_Y == 2, na.rm = T)/length(H23_Y))




ppd3 <- CARB_50_LGCA_3CLASS %>% 
  group_by(C) %>% 
  summarise(d3H0_0 = sum(H0_X_X == "0.000", na.rm = T)/length(H0_X_X), 
            d3H0_1 = sum(H0_X_X == "1.000", na.rm = T)/length(H0_X_X), 
            d3H0_2 = sum(H0_X_X == "2.000", na.rm = T)/length(H0_X_X),
            d3H1_0 = sum(H1_X_X == "0.000", na.rm = T)/length(H1_X_X),
            d3H1_1 = sum(H1_X_X == "1.000", na.rm = T)/length(H1_X_X), 
            d3H1_2 = sum(H1_X_X == "2.000", na.rm = T)/length(H1_X_X),
            d3H2_0 = sum(H2_X_X == "0.000", na.rm = T)/length(H2_X_X),
            d3H2_1 = sum(H2_X_X == "1.000", na.rm = T)/length(H2_X_X), 
            d3H2_2 = sum(H2_X_X == "2.000", na.rm = T)/length(H2_X_X),
            d3H3_0 = sum(H3_X_X == "0.000", na.rm = T)/length(H3_X_X),
            d3H3_1 = sum(H3_X_X == "1.000", na.rm = T)/length(H3_X_X), 
            d3H3_2 = sum(H3_X_X == "2.000", na.rm = T)/length(H3_X_X),
            d3H4_0 = sum(H4_X_X == "0.000", na.rm = T)/length(H4_X_X),
            d3H4_1 = sum(H4_X_X == "1.000", na.rm = T)/length(H4_X_X), 
            d3H4_2 = sum(H4_X_X == "2.000", na.rm = T)/length(H4_X_X),
            d3H5_0 = sum(H5_X_X == "0.000", na.rm = T)/length(H5_X_X),
            d3H5_1 = sum(H5_X_X == "1.000", na.rm = T)/length(H5_X_X), 
            d3H5_2 = sum(H5_X_X == "2.000", na.rm = T)/length(H5_X_X),
            d3H6_0 = sum(H6_X_X == "0.000", na.rm = T)/length(H6_X_X),
            d3H6_1 = sum(H6_X_X == "1.000", na.rm = T)/length(H6_X_X), 
            d3H6_2 = sum(H6_X_X == "2.000", na.rm = T)/length(H6_X_X),
            d3H7_0 = sum(H7_X_X == "0.000", na.rm = T)/length(H7_X_X),
            d3H7_1 = sum(H7_X_X == "1.000", na.rm = T)/length(H7_X_X), 
            d3H7_2 = sum(H7_X_X == "2.000", na.rm = T)/length(H7_X_X),
            d3H8_0 = sum(H8_X_X == "0.000", na.rm = T)/length(H8_X_X),
            d3H8_1 = sum(H8_X_X == "1.000", na.rm = T)/length(H8_X_X), 
            d3H8_2 = sum(H8_X_X == "2.000", na.rm = T)/length(H8_X_X),
            d3H9_0 = sum(H9_X_X == "0.000", na.rm = T)/length(H9_X_X),
            d3H9_1 = sum(H9_X_X == "1.000", na.rm = T)/length(H9_X_X), 
            d3H9_2 = sum(H9_X_X == "2.000", na.rm = T)/length(H9_X_X),
            d3H10_0 = sum(H10_X_X == "0.000", na.rm = T)/length(H10_X_X),
            d3H10_1 = sum(H10_X_X == "1.000", na.rm = T)/length(H10_X_X), 
            d3H10_2 = sum(H10_X_X == "2.000", na.rm = T)/length(H10_X_X),
            d3H11_0 = sum(H11_X_X == "0.000", na.rm = T)/length(H11_X_X),
            d3H11_1 = sum(H11_X_X == "1.000", na.rm = T)/length(H11_X_X), 
            d3H11_2 = sum(H11_X_X == "2.000", na.rm = T)/length(H11_X_X),
            d3H12_0 = sum(H12_X_X == "0.000", na.rm = T)/length(H12_X_X),
            d3H12_1 = sum(H12_X_X == "1.000", na.rm = T)/length(H12_X_X), 
            d3H12_2 = sum(H12_X_X == "2.000", na.rm = T)/length(H12_X_X),
            d3H13_0 = sum(H13_X_X == "0.000", na.rm = T)/length(H13_X_X),
            d3H13_1 = sum(H13_X_X == "1.000", na.rm = T)/length(H13_X_X), 
            d3H13_2 = sum(H13_X_X == "2.000", na.rm = T)/length(H13_X_X),
            d3H14_0 = sum(H14_X_X == "0.000", na.rm = T)/length(H14_X_X),
            d3H14_1 = sum(H14_X_X == "1.000", na.rm = T)/length(H14_X_X), 
            d3H14_2 = sum(H14_X_X == "2.000", na.rm = T)/length(H14_X_X),
            d3H15_0 = sum(H15_X_X == "0.000", na.rm = T)/length(H15_X_X),
            d3H15_1 = sum(H15_X_X == "1.000", na.rm = T)/length(H15_X_X), 
            d3H15_2 = sum(H15_X_X == "2.000", na.rm = T)/length(H15_X_X),
            d3H16_0 = sum(H16_X_X == "0.000", na.rm = T)/length(H16_X_X),
            d3H16_1 = sum(H16_X_X == "1.000", na.rm = T)/length(H16_X_X), 
            d3H16_2 = sum(H16_X_X == "2.000", na.rm = T)/length(H16_X_X),
            d3H17_0 = sum(H17_X_X == "0.000", na.rm = T)/length(H17_X_X),
            d3H17_1 = sum(H17_X_X == "1.000", na.rm = T)/length(H17_X_X), 
            d3H17_2 = sum(H17_X_X == "2.000", na.rm = T)/length(H17_X_X),
            d3H18_0 = sum(H18_X_X == "0.000", na.rm = T)/length(H18_X_X),
            d3H18_1 = sum(H18_X_X == "1.000", na.rm = T)/length(H18_X_X), 
            d3H18_2 = sum(H18_X_X == "2.000", na.rm = T)/length(H18_X_X),
            d3H19_0 = sum(H19_X_X == "0.000", na.rm = T)/length(H19_X_X),
            d3H19_1 = sum(H19_X_X == "1.000", na.rm = T)/length(H19_X_X), 
            d3H19_2 = sum(H19_X_X == "2.000", na.rm = T)/length(H19_X_X),
            d3H20_0 = sum(H20_X_X == "0.000", na.rm = T)/length(H20_X_X),
            d3H20_1 = sum(H20_X_X == "1.000", na.rm = T)/length(H20_X_X), 
            d3H20_2 = sum(H20_X_X == "2.000", na.rm = T)/length(H20_X_X),
            d3H21_0 = sum(H21_X_X == "0.000", na.rm = T)/length(H21_X_X),
            d3H21_1 = sum(H21_X_X == "1.000", na.rm = T)/length(H21_X_X), 
            d3H21_2 = sum(H21_X_X == "2.000", na.rm = T)/length(H21_X_X),
            d3H22_0 = sum(H22_X_X == "0.000", na.rm = T)/length(H22_X_X),
            d3H22_1 = sum(H22_X_X == "1.000", na.rm = T)/length(H22_X_X), 
            d3H22_2 = sum(H22_X_X == "2.000", na.rm = T)/length(H22_X_X),
            d3H23_0 = sum(H23_X_X == "0.000", na.rm = T)/length(H23_X_X),
            d3H23_1 = sum(H23_X_X == "1.000", na.rm = T)/length(H23_X_X), 
            d3H23_2 = sum(H23_X_X == "2.000", na.rm = T)/length(H23_X_X))


ppd4 <- CARB_50_LGCA_3CLASS %>% 
  group_by(C) %>% 
  summarise(d4H0_0 = sum(H0_Y_Y == "0.000", na.rm = T)/length(H0_Y_Y), 
            d4H0_1 = sum(H0_Y_Y == "1.000", na.rm = T)/length(H0_Y_Y), 
            d4H0_2 = sum(H0_Y_Y == "2.000", na.rm = T)/length(H0_Y_Y),
            d4H1_0 = sum(H1_Y_Y == "0.000", na.rm = T)/length(H1_Y_Y),
            d4H1_1 = sum(H1_Y_Y == "1.000", na.rm = T)/length(H1_Y_Y), 
            d4H1_2 = sum(H1_Y_Y == "2.000", na.rm = T)/length(H1_Y_Y),
            d4H2_0 = sum(H2_Y_Y == "0.000", na.rm = T)/length(H2_Y_Y),
            d4H2_1 = sum(H2_Y_Y == "1.000", na.rm = T)/length(H2_Y_Y), 
            d4H2_2 = sum(H2_Y_Y == "2.000", na.rm = T)/length(H2_Y_Y),
            d4H3_0 = sum(H3_Y_Y == "0.000", na.rm = T)/length(H3_Y_Y),
            d4H3_1 = sum(H3_Y_Y == "1.000", na.rm = T)/length(H3_Y_Y), 
            d4H3_2 = sum(H3_Y_Y == "2.000", na.rm = T)/length(H3_Y_Y),
            d4H4_0 = sum(H4_Y_Y == "0.000", na.rm = T)/length(H4_Y_Y),
            d4H4_1 = sum(H4_Y_Y == "1.000", na.rm = T)/length(H4_Y_Y), 
            d4H4_2 = sum(H4_Y_Y == "2.000", na.rm = T)/length(H4_Y_Y),
            d4H5_0 = sum(H5_Y_Y == "0.000", na.rm = T)/length(H5_Y_Y),
            d4H5_1 = sum(H5_Y_Y == "1.000", na.rm = T)/length(H5_Y_Y), 
            d4H5_2 = sum(H5_Y_Y == "2.000", na.rm = T)/length(H5_Y_Y),
            d4H6_0 = sum(H6_Y_Y == "0.000", na.rm = T)/length(H6_Y_Y),
            d4H6_1 = sum(H6_Y_Y == "1.000", na.rm = T)/length(H6_Y_Y), 
            d4H6_2 = sum(H6_Y_Y == "2.000", na.rm = T)/length(H6_Y_Y),
            d4H7_0 = sum(H7_Y_Y == "0.000", na.rm = T)/length(H7_Y_Y),
            d4H7_1 = sum(H7_Y_Y == "1.000", na.rm = T)/length(H7_Y_Y), 
            d4H7_2 = sum(H7_Y_Y == "2.000", na.rm = T)/length(H7_Y_Y),
            d4H8_0 = sum(H8_Y_Y == "0.000", na.rm = T)/length(H8_Y_Y),
            d4H8_1 = sum(H8_Y_Y == "1.000", na.rm = T)/length(H8_Y_Y), 
            d4H8_2 = sum(H8_Y_Y == "2.000", na.rm = T)/length(H8_Y_Y),
            d4H9_0 = sum(H9_Y_Y == "0.000", na.rm = T)/length(H9_Y_Y),
            d4H9_1 = sum(H9_Y_Y == "1.000", na.rm = T)/length(H9_Y_Y), 
            d4H9_2 = sum(H9_Y_Y == "2.000", na.rm = T)/length(H9_Y_Y),
            d4H10_0 = sum(H10_Y_Y == "0.000", na.rm = T)/length(H10_Y_Y),
            d4H10_1 = sum(H10_Y_Y == "1.000", na.rm = T)/length(H10_Y_Y), 
            d4H10_2 = sum(H10_Y_Y == "2.000", na.rm = T)/length(H10_Y_Y),
            d4H11_0 = sum(H11_Y_Y == "0.000", na.rm = T)/length(H11_Y_Y),
            d4H11_1 = sum(H11_Y_Y == "1.000", na.rm = T)/length(H11_Y_Y), 
            d4H11_2 = sum(H11_Y_Y == "2.000", na.rm = T)/length(H11_Y_Y),
            d4H12_0 = sum(H12_Y_Y == "0.000", na.rm = T)/length(H12_Y_Y),
            d4H12_1 = sum(H12_Y_Y == "1.000", na.rm = T)/length(H12_Y_Y), 
            d4H12_2 = sum(H12_Y_Y == "2.000", na.rm = T)/length(H12_Y_Y),
            d4H13_0 = sum(H13_Y_Y == "0.000", na.rm = T)/length(H13_Y_Y),
            d4H13_1 = sum(H13_Y_Y == "1.000", na.rm = T)/length(H13_Y_Y), 
            d4H13_2 = sum(H13_Y_Y == "2.000", na.rm = T)/length(H13_Y_Y),
            d4H14_0 = sum(H14_Y_Y == "0.000", na.rm = T)/length(H14_Y_Y),
            d4H14_1 = sum(H14_Y_Y == "1.000", na.rm = T)/length(H14_Y_Y), 
            d4H14_2 = sum(H14_Y_Y == "2.000", na.rm = T)/length(H14_Y_Y),
            d4H15_0 = sum(H15_Y_Y == "0.000", na.rm = T)/length(H15_Y_Y),
            d4H15_1 = sum(H15_Y_Y == "1.000", na.rm = T)/length(H15_Y_Y), 
            d4H15_2 = sum(H15_Y_Y == "2.000", na.rm = T)/length(H15_Y_Y),
            d4H16_0 = sum(H16_Y_Y == "0.000", na.rm = T)/length(H16_Y_Y),
            d4H16_1 = sum(H16_Y_Y == "1.000", na.rm = T)/length(H16_Y_Y), 
            d4H16_2 = sum(H16_Y_Y == "2.000", na.rm = T)/length(H16_Y_Y),
            d4H17_0 = sum(H17_Y_Y == "0.000", na.rm = T)/length(H17_Y_Y),
            d4H17_1 = sum(H17_Y_Y == "1.000", na.rm = T)/length(H17_Y_Y), 
            d4H17_2 = sum(H17_Y_Y == "2.000", na.rm = T)/length(H17_Y_Y),
            d4H18_0 = sum(H18_Y_Y == "0.000", na.rm = T)/length(H18_Y_Y),
            d4H18_1 = sum(H18_Y_Y == "1.000", na.rm = T)/length(H18_Y_Y), 
            d4H18_2 = sum(H18_Y_Y == "2.000", na.rm = T)/length(H18_Y_Y),
            d4H19_0 = sum(H19_Y_Y == "0.000", na.rm = T)/length(H19_Y_Y),
            d4H19_1 = sum(H19_Y_Y == "1.000", na.rm = T)/length(H19_Y_Y), 
            d4H19_2 = sum(H19_Y_Y == "2.000", na.rm = T)/length(H19_Y_Y),
            d4H20_0 = sum(H20_Y_Y == "0.000", na.rm = T)/length(H20_Y_Y),
            d4H20_1 = sum(H20_Y_Y == "1.000", na.rm = T)/length(H20_Y_Y), 
            d4H20_2 = sum(H20_Y_Y == "2.000", na.rm = T)/length(H20_Y_Y),
            d4H21_0 = sum(H21_Y_Y == "0.000", na.rm = T)/length(H21_Y_Y),
            d4H21_1 = sum(H21_Y_Y == "1.000", na.rm = T)/length(H21_Y_Y), 
            d4H21_2 = sum(H21_Y_Y == "2.000", na.rm = T)/length(H21_Y_Y),
            d4H22_0 = sum(H22_Y_Y == "0.000", na.rm = T)/length(H22_Y_Y),
            d4H22_1 = sum(H22_Y_Y == "1.000", na.rm = T)/length(H22_Y_Y), 
            d4H22_2 = sum(H22_Y_Y == "2.000", na.rm = T)/length(H22_Y_Y),
            d4H23_0 = sum(H23_Y_Y == "0.000", na.rm = T)/length(H23_Y_Y),
            d4H23_1 = sum(H23_Y_Y == "1.000", na.rm = T)/length(H23_Y_Y), 
            d4H23_2 = sum(H23_Y_Y == "2.000", na.rm = T)/length(H23_Y_Y))





ppd1_long <- ppd1 %>% 
  gather(DHour, Prob, -C) %>% 
  separate(DHour, into = c("DHourN", "Carbo"), sep = "_") 
ppd2_long <- ppd2 %>% 
  gather(DHour, Prob, -C) %>% 
  separate(DHour, into = c("DHourN", "Carbo"), sep = "_") 
ppd3_long <- ppd3 %>% 
  gather(DHour, Prob, -C) %>% 
  separate(DHour, into = c("DHourN", "Carbo"), sep = "_") 
ppd4_long <- ppd4 %>% 
  gather(DHour, Prob, -C) %>% 
  separate(DHour, into = c("DHourN", "Carbo"), sep = "_") 


pp <- bind_rows(ppd1_long, ppd2_long, ppd3_long, ppd4_long)





pp$DHourN <- factor(pp$DHourN, 
                        levels = c("d1H0", 
                                   "d1H1", 
                                   "d1H2", 
                                   "d1H3", 
                                   "d1H4", 
                                   "d1H5", 
                                   "d1H6", 
                                   "d1H7", 
                                   "d1H8", 
                                   "d1H9", 
                                   "d1H10",
                                   "d1H11",
                                   "d1H12",
                                   "d1H13",
                                   "d1H14",
                                   "d1H15",
                                   "d1H16",
                                   "d1H17",
                                   "d1H18",
                                   "d1H19",
                                   "d1H20",
                                   "d1H21",
                                   "d1H22",
                                   "d1H23",
                                   "d2H0", 
                                   "d2H1", 
                                   "d2H2", 
                                   "d2H3", 
                                   "d2H4", 
                                   "d2H5", 
                                   "d2H6", 
                                   "d2H7", 
                                   "d2H8", 
                                   "d2H9", 
                                   "d2H10",
                                   "d2H11",
                                   "d2H12",
                                   "d2H13",
                                   "d2H14",
                                   "d2H15",
                                   "d2H16",
                                   "d2H17",
                                   "d2H18",
                                   "d2H19",
                                   "d2H20",
                                   "d2H21",
                                   "d2H22",
                                   "d2H23",
                                   "d3H0", 
                                   "d3H1", 
                                   "d3H2", 
                                   "d3H3", 
                                   "d3H4", 
                                   "d3H5", 
                                   "d3H6", 
                                   "d3H7", 
                                   "d3H8", 
                                   "d3H9", 
                                   "d3H10",
                                   "d3H11",
                                   "d3H12",
                                   "d3H13",
                                   "d3H14",
                                   "d3H15",
                                   "d3H16",
                                   "d3H17",
                                   "d3H18",
                                   "d3H19",
                                   "d3H20",
                                   "d3H21",
                                   "d3H22",
                                   "d3H23",
                                   "d4H0", 
                                   "d4H1", 
                                   "d4H2", 
                                   "d4H3", 
                                   "d4H4", 
                                   "d4H5", 
                                   "d4H6", 
                                   "d4H7", 
                                   "d4H8", 
                                   "d4H9", 
                                   "d4H10",
                                   "d4H11",
                                   "d4H12",
                                   "d4H13",
                                   "d4H14",
                                   "d4H15",
                                   "d4H16",
                                   "d4H17",
                                   "d4H18",
                                   "d4H19",
                                   "d4H20",
                                   "d4H21",
                                   "d4H22",
                                   "d4H23"))







library(ggthemr)
ggthemr("fresh", layout = "scientific")
library(ggplot2)


ggplot(pp[pp$C == 1, ], aes(y = Prob, x=DHourN, group = Carbo, color = Carbo)) + 
  geom_point(size = 2) + 
  geom_line(size = 1) + 
  theme(axis.title = element_text(size = 18), 
        axis.text = element_text(size = 10), 
        axis.line = element_line(colour = "black"), 
        panel.border = element_blank(), 
        panel.background = element_blank(), 
        legend.text = element_text(size = 15), 
        legend.title = element_text(size = 15) 
        # legend.position = "bottom", 
        # legend.direction = "horizontal"
  ) + 
  labs(title = "Class 1", x = "Hour of the day", y = "Probability",
       color = "Carbohydrate\nintake") + 
  scale_color_discrete(labels = c("Not eating", "< 50%", ">= 50%")) + 
  ylim(c(0,1)) + 
  theme(axis.text.x = element_text(angle = 90, hjust = 1))



ggplot(pp[pp$C == 2, ], aes(y = Prob, x=DHourN, group = Carbo, color = Carbo)) + 
  geom_point(size = 2) + 
  geom_line(size = 1) + 
  theme(axis.title = element_text(size = 18), 
        axis.text = element_text(size = 10), 
        axis.line = element_line(colour = "black"), 
        panel.border = element_blank(), 
        panel.background = element_blank(), 
        legend.text = element_text(size = 15), 
        legend.title = element_text(size = 15) 
        # legend.position = "bottom", 
        # legend.direction = "horizontal"
  ) + 
  labs(title = "Class 2", x = "Hour of the day", y = "Probability",
       color = "Carbohydrate\nintake") + 
  scale_color_discrete(labels = c("Not eating", "< 50%", ">= 50%")) + 
  ylim(c(0,1)) + 
  theme(axis.text.x = element_text(angle = 90, hjust = 1))



ggplot(pp[pp$C == 3, ], aes(y = Prob, x=DHourN, group = Carbo, color = Carbo)) +
  geom_point(size = 2) + 
  geom_line(size = 1) + 
  theme(axis.title = element_text(size = 18), 
        axis.text = element_text(size = 10), 
        axis.line = element_line(colour = "black"), 
        panel.border = element_blank(), 
        panel.background = element_blank(), 
        legend.text = element_text(size = 15), 
        legend.title = element_text(size = 15) 
        # legend.position = "bottom", 
        # legend.direction = "horizontal"
  ) + 
  labs(title = "Class 3", x = "Hour of the day", y = "Probability",
       color = "Carbohydrate\nintake") + 
  scale_color_discrete(labels = c("Not eating", "< 50%", ">= 50%")) + 
  ylim(c(0,1)) + 
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
